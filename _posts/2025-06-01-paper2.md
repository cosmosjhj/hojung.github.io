---
layout: post
title: Paper 2
subtitle: 'FreeCG: Free the Design Space of Clebsch-Gordan Transform for Machine Learning Force Fields'
tags: [test]
comments: true
mathjax: true
author: Hojung Jung
---

> **TL;DR ‚Äî** FreeCG turns the traditional ‚Äúone-CG-per-neighbor‚Äù strait-jacket into a **design-free, invariant space**, then layers in three upgrades (Group-CG + Sparse Path, Abstract-Edge Shuffling, Attention Enhancer).  
> The result: **state-of-the-art accuracy *and* 3‚Äì4 √ó speed-ups** on MD17/22, QM9, OC20 **at lower memory**.

---

# 1‚ÄÇMotivation

* **Machine-Learning force fields (MLFFs)** promise **DFT accuracy** while running orders faster, but they must honour *all* molecular symmetries.  
* **Clebsch‚ÄìGordan (CG) transforms** are the workhorse for coupling high-order spherical irreps inside equivariant GNNs; unfortunately they must be **applied identically to every neighbour edge** to keep permutation-equivariance. That makes them both *expensive* and *rigid* (no custom per-edge logic).

FreeCG asks: *what if we shift CG to a permutation-**invariant** basis first?*

---

# 2‚ÄÇMethod

## 2.1‚ÄÇInvariance ‚áí Freedom  

A simple but powerful rule (‚Äúinvariance transitivity‚Äù):  

> *If \(h_i(x)\) are permutation-invariant, **any** function $g(h_1,h_2,\dots)$ is also invariant.

Thus, once we build **abstract edges** that are invariant, we may run **any CG transform we like** on them‚Äîparameter sharing, neighbour loops, even the number of edges‚Äî*without breaking global equivariance*.

## 2.2‚ÄÇLayer schematic (Fig.‚Äã1 in the paper)  

| Step | What happens | Complexity / effect |
|------|--------------|---------------------|
| **Abstract edges** | ViSNet-style cross-attention compresses all real edges into \(T\) *edge tensors* that are already permutation-invariant.} | eliminates per-neighbour CG |
| **Group-CG** | Split \(T\) edges into \(G\) groups; run CG inside each group only ‚Üí \(O(T^2/G)\). | up to 64√ó fewer CG paths |
| **Sparse path** | Keep only four \(O(3)\) coupling paths \((l,p)=(1,-1),(2,1)\) (vs. eight in full \(SO(3)\)). | 2‚Äì4√ó flop cut |
| **Edge shuffling** | Deterministic index shift (‚åä1.5 ¬∑ T/G‚åã) mixes info across groups each layer. | avoids group silos |
| **Attention enhancer** | Dot-product between real edge and all abstract edges, added to cross-attention score. | better long-range coupling |

Mathematically, the **Group-CG** is (simplified):

$$
dE_{i}^{L+1}
=\sum_{g=1}^{G}
\sum_{l_1,l_2}
\sum_{t_1,t_2 \in U_g}
\mathbf W^{l_1,l_2}_{t_1 t_2}
(\mathbf E_i^{L,l_1})_{t_1}
\otimes(\hat{\mathbf E}_i^{L,l_2})_{t_2} ,
\qquad \text{(CG within group)}\!
$$

where \(U_g\) indexes edges in group \(g\) 

---

# 3‚ÄÇBenchmarks

### 3.1‚ÄÇForce-field datasets  

| Dataset | Task | Prev. SOTA | **FreeCG** | Œî |
|---------|------|------------|------------|---|
| **MD17** (Aspirin) | Force MAE (kcal mol‚Åª¬π √Ö‚Åª¬π) | ViSNet 0 .145 | **0 .122** | ‚Äì15 %  |
| **rMD17** (Aspirin) | Force MAE | QuinNet 0 .143 | **0 .121** | ‚Äì15 % |
| **MD22** (Ac-Ala3-NHMe) | Force MAE | ViSNet-Imp 0 .071 | **0 .053** | ‚Äì25 % |

### 3.2‚ÄÇMolecular-property regression (QM9)  

FreeCG attains **best error on 9 / 12 properties**, beating ViSNet on dipole, polarizability, HOMO, LUMO and gap by 15‚Äì20 %.

### 3.3‚ÄÇCatalysis benchmark (OC20 S2EF)  

Across in-domain and three out-of-domain splits, FreeCG improves force MAE by 10‚Äì13 % versus ViSNet while cutting energy MAE by up to 33 %.

### 3.4‚ÄÇEfficiency  

* **Inference speed** on the 166-atom Chignolin mini-protein: fastest among ViSNet, NequIP, Allegro for equal batch 32 .  
* **Memory**: lowest peak GPU memory among CG-based models.  
* **CG path count**: full CG = 64 paths; Group-CG (G = 4) + sparse path = **4 paths** (16√ó flop drop).

---

# 4‚ÄÇAblations & extensions  

* **Module ablation** (Tab.‚Äã7): each component (Group-CG, Shuffling, Sparse path, Attention) yields 3‚Äì8 % MAE gain; all together = best. 
* **Shuffle stride**: ‚åä1.5 T/G‚åã beats 0.5 or 1.0 strides.  
* **Group count** \(G\): more groups ‚Üí faster inference until memory bandwidth dominates.  
* **Plug-in to QuinNet**: adding FreeCG blocks gives **‚àº2√ó faster convergence and lower final MAE** after 1 500 epochs.

---

# 5‚ÄÇQualitative highlights  

* **Mini-protein Chignolin**: FreeCG tracks folded ‚Üî unfolded energy landscape better than ViSNet and yields lower RMSD during 300 ps MD.  
* **Periodic systems (water, LiPS)**: radial-distribution functions reproduced with 50 % lower force MAE than second-best model.

---

# 6‚ÄÇStrengths & caveats

| üëç Strength | ‚ö†Ô∏è Limitation |
|------------|--------------|
| Breaks the neighbour-wise CG bottleneck, **huge design freedom**. | Still relies on ViSNet backbone; other architectures need adaptation. |
| **O(3) equivariance** with *fewer* paths than \(SO(3)\). | No explicit treatment of spin‚Äìorbit or time-dependent fields. |
| SOTA accuracy **and** faster / leaner than NequIP, Allegro. | Real gains taper when dataset size ‚â™ neighbour count (small molecules). |
| Plug-and-play: enhances QuinNet with minimal code. | Hyper-params (T,G, stride) add tuning surface. |

---

# 7‚ÄÇTake-aways for practitioners

* **Need speed?** Use Group-CG + Sparse path: start with \(T = 12, G = 4\).  
* **Need accuracy?** Keep O(3) paths but bump abstract-edge count instead of neighbours.  
* **Other GNNs?** Identify any invariant pooling first; drop FreeCG atop.

---

# 8‚ÄÇConclusion

FreeCG shows that moving the heavy CG transform to **permutation-invariant abstract edges** ***completely frees*** the design space: you can sparsify, group, shuffle or re-weight paths *at will* while keeping global symmetry.  
The resulting model **matches or beats the best MLFFs on every major benchmark and runs 3‚Äì4√ó faster**. More importantly, it introduces a *paradigm*‚Äî**‚Äúinvariants first, equivariance later‚Äù**‚Äîripe for adoption in robotics, point-cloud vision and beyond.

*Paper:* Shao *et al.* ‚ÄúFreeCG: Free the Design Space of Clebsch‚ÄìGordan Transform for Machine-Learning Force Fields‚Äù, ICLR 2025.:contentReference[oaicite:42]{index=42}
