---
layout: post
title: Paper 1
subtitle: 'ENHANCING THE SCALABILITY AND APPLICABILITY OF KOHN-SHAM HAMILTONIANS FOR MOLECULAR SYSTEMS'
cover-img: /assets/img/path.jpg
thumbnail-img: /assets/img/thumb.png
share-img: /assets/img/path.jpg
tags: [books, test]
author: Hojung Jung
---

{: .box-success}
One line summary : This paper enhances DFT calculation by proposing novel architecture with refined loss that considers eigenvalues of the Kohn-Sham equations.

# 1 Density-Functional Theory (DFT)

### 1.1 Kohn–Sham formulation  
For nuclei  

$$
\mathcal{M} = 
\bigl\{\,Z_{1},\dots,Z_{N}\;;\;\mathbf R_{1},\dots,\mathbf R_{N}\bigr\},
$$  

DFT solves  

$$
\mathbf H\,\mathbf C
\;=\;
\mathbf S\,\mathbf C\,\boldsymbol{\epsilon},
\qquad
\rho(\mathbf r)=\sum_{i\in\text{occ}}
\bigl|\psi_{i}(\mathbf r)\bigr|^{2}.
$$

| Symbol | Meaning | Size |
|--------|---------|------|
| $\mathbf H[\rho]$ | KS Hamiltonian: $\mathbf T+\mathbf V_{\text{ext}}+\mathbf V_{\text H}[\rho]+\mathbf V_{\text{xc}}[\rho]$ | $B\times B$ |
| $\mathbf S$ | AO overlap | $B\times B$ |
| $\mathbf C$ | AO→MO coeffs | $B\times N$ |
| $\boldsymbol{\epsilon}$ | $\mathrm{diag}(\epsilon_i)$ | $N\times N$ |

### 1.2 SCF cost  
1. **Build** $\mathbf H^{(k)}[\rho^{(k-1)}]$ – $\mathcal O(B^{3})$  
2. **Solve** eigensystem – $\mathcal O(B^{3})$  
3. **Mix** density, test convergence  

Total: $\mathcal O(TB^{3})$ with $B\!\sim\!N$.

### 1.3 Why predict $\hat{\mathbf H}$?  
* One diagonalisation ⇒ energies, forces, dipoles …  
* At most one SCF micro-step (Δ-SCF)  
* Asymptotic cost $\mathcal O(B^{3})$.

---

# 2 Method: WALoss + WANet

## 2.1 Element-wise losses break at scale  
On PubChemQH (40–100 atoms) a $10^{-2}$ relative MAE in $\mathbf H$ yields  
$10^{6}\,\text{kcal}\,\text{mol}^{-1}$ energy error.

Perturbative bound  

$$
\bigl|\lambda_i(\hat{\mathbf H},\mathbf S)-\lambda_i(\mathbf H,\mathbf S)\bigr|
\le
\frac{\kappa(\mathbf S)}{\lVert\mathbf S\rVert_2}\,
\lVert\Delta\mathbf H\rVert_{1,1},
$$  

shows ill-conditioned $\mathbf S$ and large $B$ amplify small entry-wise errors.

## 2.2 Wave-function Alignment Loss (WALoss)

* **Simultaneous reduction** gives $\mathbf C^{\star}$ with  
  $(\mathbf C^{\star})^{\!\top}\mathbf S\,\mathbf C^{\star}=\mathbf I$.
* **Evaluate**  

  $$
  \tilde{\mathbf H}=(\mathbf C^{\star})^{\!\top}\hat{\mathbf H}\,\mathbf C^{\star}.
  $$

* **Align key eigenvalues**

  $$
  \mathcal L_{\text{WA}}=
  \rho\sum_{j\in\text{occ}\cup\{\text{LUMO}\}}
    \bigl|\tilde H_{jj}-\epsilon^{\star}_{j}\bigr|^{2}
  +\;
  \xi\sum_{j\notin\text{occ}\cup\{\text{LUMO}\}}
    \bigl|\tilde H_{jj}-\epsilon^{\star}_{j}\bigr|^{2},
  \quad\rho\gg\xi.
  $$  

No back-prop through an eigensolver → stable training.

## 2.3 WANet architecture  

| Stage | Core idea | Cost | Role |
|-------|-----------|------|------|
| Node conv. | eSCN (SO (2)) | $O(L^{3})$ | Cheap irreps |
| Pair block | Sparse MoE | const. | Off-diagonals |
| Diagonal block | MACE many-body | $O(K\nu)$ | Correlation |
| Head | Clebsch–Gordan → Hermitian | — | $\hat{\mathbf H}$ |

SE (3)-equivariant throughout; output Hermitian.

---

# 3 Experiments

## 3.1 Datasets

| Set | Size | Atom range | Level |
|-----|------|------------|-------|
| QH9 | 130 k | ≤ 9 heavy | B3LYP/def2-SVP |
| PubChemQH | 50 k | 40–100 | B3LYP/def2-TZV |

## 3.2 Metrics  
Hamiltonian MAE, eigenspectrum MAE, eigen-vector cosine, total-energy MAE, relative SCF steps.

## 3.3 PubChemQH results

| Model | MAE($E_\text{tot}$) | Rel. SCF | MAE($\mathbf H$) |
|-------|--------------------|----------|------------------|
| QHNet | 65 721 | 3.7× | 0.78 |
| QHNet + WA | 75.6 | 0.9× | 0.52 |
| **WANet + WA** | **47.2** | **0.82×** | **0.47** |
| Init guess | 374 | 1.0× | 0.55 |

Energy ↓ × 1347, SCF ↓ 18 %.

---

# 4 Discussion

* WALoss enforces first-order perturbation consistency → stability.  
* eSCN lowers SO (3) cost $O(L^{6}) \to O(L^{3})$; MoE handles long-range physics.  
* One $\hat{\mathbf H}$ gives energies, dipoles, spectra ⇒ beats single-task regressors.  
* Open: dataset cost, SCF-free forces, periodic transfer.

---

# 5 Conclusion

WALoss + WANet erase catastrophic scaling:

* **Energy error ↓ 10³×**  
* **SCF wall-time ↓ ≈ 18 %**  
* Generalises to 180-atom alkanes.

A new SOTA for deep-learning-augmented DFT.
