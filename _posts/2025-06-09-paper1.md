---
layout: post
title: Paper 1
subtitle: 'ENHANCING THE SCALABILITY AND APPLICABILITY OF KOHN-SHAM HAMILTONIANS FOR MOLECULAR SYSTEMS'
cover-img: /assets/img/path.jpg
thumbnail-img: /assets/img/thumb.png
share-img: /assets/img/path.jpg
tags: [books, test]
author: Hojung Jung
---

{: .box-success}
One line summary : This paper enhances DFT calculation by proposing novel architecture with refined loss that considers eigenvalues of the Kohn-Sham equations.

## 1. Density Functional Theory (DFT) and its preliminaries
- **Kohn–Sham problem**  
  \[
    \mathbf H(\mathbf C)\,\mathbf C = \mathbf S\,\mathbf C\,\boldsymbol\epsilon,
  \]
  with Hamiltonian \(\mathbf H=\mathbf T+\mathbf V_\text{ext}+ \mathbf V_\text{H}[\rho]+\mathbf V_\text{xc}[\rho]\), overlap \(\mathbf S\), coefficients \(\mathbf C\) and orbital energies \(\boldsymbol\epsilon\).
- **SCF cost** scales \(\mathcal O(B^3)\) per iteration and \(\mathcal O(N^{3\text{–}4})\) overall.
- **Goal** Predict a physically correct \(\hat{\mathbf H}\) from geometry once, avoiding SCF loops.

---

## 2. Method: Wave-function Alignment Loss / WANet

### 2.1 Why element-wise MAE/MSE fail
- **Scaling-Induced MAE–Applicability Divergence (SAD)**: for \(B\gtrsim 400\) even 0.01 % MAE in \(\mathbf H\) can cause >10\(^6\) kcal mol\(^{-1}\) total-energy error.
- Perturbation bound  
  \[
    \bigl|\lambda_i(\hat{\mathbf H},\mathbf S)-\lambda_i(\mathbf H,\mathbf S)\bigr|
      \;\le\; \tfrac{\kappa(\mathbf S)}{\|\mathbf S\|_2}\,\|\Delta\mathbf H\|_{1,1},
  \]
  shows eigen-errors amplify with poor overlap conditioning and basis size.

### 2.2 Wave-function Alignment Loss (WALoss)
1. **Reference basis** \(\mathbf C^\star\) from robust simultaneous reduction.  
2. **Loss**  
   \[
     \mathcal L_\text{WA}=
       \frac1n\sum_i\Bigl[
       \rho\!\!\!\sum_{j\in \text{occ}\cup\{\text{LUMO}\}}
         \bigl|(\mathbf C^\star_{j})^\top\hat{\mathbf H}_i\mathbf C^\star_{j}
               -\epsilon_j^\star\bigr|^2
       +\xi\!\!\!\sum_{j\notin\cdots}\bigl|\cdot\bigr|^2\Bigr],
   \]
   with \(\rho\gg\xi\).  
3. **No back-prop through eigensolver** – gradients use the bilinear form only.

### 2.3 WANet architecture
| Block | Key idea | Benefit |
|-------|----------|---------|
| **Node Convolution (eSCN)** | Replace SO(3) conv with cheaper SO(2) ops | Cut cost from \(O(L^6)\to O(L^3)\) |
| **Sparse MoE (long/short-range)** | Distance-gated experts for off-diagonals | Captures near-/far-field physics, keeps parameters sparse |
| **Many-body layer (MACE)** | Density trick + high-order Clebsch-Gordan | Accurate diagonal blocks & many-body effects |
| **Output** | Hermitian, SE(3)-equivariant \(\hat{\mathbf H}\) | Ready for property derivation |

---

## 3. Experiments

### 3.1 PubChemQH (40–100 atoms, 50 k mols)

| Model | MAE\(_H\) ↓ | System-Energy MAE (kcal mol\(^{-1}\)) ↓ | SCF iters (rel.) ↓ |
|-------|-------------|------------------------------------------|--------------------|
| QHNet                 | 0.78 | 65 721 | 3.71× |
| **WANet + WALoss**    | **0.47** | **47.2** | **0.82×** |
| WANet (no WA)         | 0.63 | 63 579 | 3.34× |

*Total-energy error reduced **× 1347**, SCF steps ↓ 18 %.*

### 3.2 QH9 (≤9 heavy atoms)

| Setting | Best baseline | WANet + WALoss |
|---------|---------------|----------------|
| Stable  | Hamiltonian MAE 0.051 | **0.091**<br>(occupied-energy MAE lowest, \(C\)-similarity 0.969) |
| Dynamic | C-similarity 0.997 | **0.998** |

### 3.3 Property regression baseline

| Property | Equiformer V2 | **WANet + WALoss** |
|----------|---------------|--------------------|
| \(\epsilon_\text{LUMO}\) MAE (kcal mol\(^{-1}\)) | 6.96 | **0.71** |
| Gap \(\epsilon_\Delta\) MAE | 3.22 | **1.33** |

### 3.4 Scalability: elongated alkanes (up to 182 atoms)  
WALoss keeps HOMO/LUMO MAE < 100 kcal mol\(^{-1}\) where other models diverge.

---

## 4. Discussion (personal viewpoint)
* **Physics-informed supervision** (WALoss) aligns learning with first-order perturbation theory, curing SAD.
* **Representation matters**: eSCN + sparse MoE scale gracefully with basis size.
* **Versatility**: one \(\hat{\mathbf H}\) yields energies, densities, dipoles, excited states – unlike single-task regressors.
* **Limitations & future work**  
  * Dataset generation (PubChemQH) cost ≈ 1 month on 128 V100s.  
  * WALoss ignores self-consistent Fock response; iterative alignment could help.  
  * Generalisation to mixed basis sets / solids remains open.

---

## 5. Conclusion
**Wave-function Alignment Loss** + **WANet** deliver accurate, SCF-accelerating Hamiltonian prediction for 10\(^2\)-atom molecules.  The approach cuts total-energy error by three orders of magnitude and trims SCF wall-time, establishing a new state of the art for deep-learning-augmented DFT.
